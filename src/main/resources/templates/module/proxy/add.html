<!DOCTYPE HTML>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-proxy-add">
			<div class="form-group">
				<label class="col-sm-3 control-label">服务ID：</label>
				<div class="col-sm-8">
					<input id="serviceId" name="serviceId" class="form-control" type="text" placeholder="只能由字母数字下划线中横线连续字符组成">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">服务名称：</label>
				<div class="col-sm-8">
					<input id="serviceName" name="serviceName" class="form-control" type="text">
				</div>
			</div>

			<div class="form-group">
				<label class="col-sm-3 control-label">请求方法：</label>
<!-- 				<div class="col-sm-8"> -->
<!-- 					<div class="radio-box" th:each="method : *{methods}"> -->
<!-- 						<input type="radio" th:id="${method.id}" th:name="${method.name}" th:value="${method.value}" th:checked="${method.checked}"> -->
<!-- 						<label th:for="${method.id}" th:text="${method.text}"></label> -->
				<div class="col-sm-8">
 					<div class="check-box" th:each="method : *{methods}">
 						<input type="checkbox" th:id="${method.id}" th:name="${method.name}" th:value="${method.value}" th:checked="${method.checked}">
 						<label th:for="${method.id}" th:text="${method.text}"></label>
 					</div> 
 				</div> 
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">请求协议：</label>
				<div class="col-sm-8">
					<div class="radio-box" th:each="protocol : *{protocols}">
						<input type="radio" th:id="${protocol.id}" th:name="${protocol.name}" th:value="${protocol.value}" th:checked="${protocol.checked}">
						<label th:for="${protocol.id}" th:text="${protocol.text}"></label>
					</div>
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">服务主机：</label>
				<div class="col-sm-8">
					<input id="host" name="host" class="form-control" type="text" placeholder="限一个地址(ip，dns，域名)">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">授权主机：</label>
				<div class="col-sm-8">
					<input id="allows" name="allows" class="form-control" type="text" placeholder="可用分号';'分割多个ip">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">端口：</label>
				<div class="col-sm-8">
					<input id="port" name="port" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">访问元素类型：</label>
				<div class="col-sm-8">
					<div class="radio-box" th:each="element_type : *{element_type}">
						<input type="radio" th:id="${element_type.id}" th:name="${element_type.name}" th:value="${element_type.value}" th:checked="${element_type.checked}">
						<label th:for="${element_type.id}" th:text="${element_type.text}"></label>
					</div>
				</div>
			</div>
			<!--
			<div class="form-group">
				<label class="col-sm-3 control-label">是否启用传入校验：</label>
				<div class="col-sm-8">
					<div class="onoffswitch">
						<input type="checkbox" th:checked="*{element_type_check_in == 'yes' ? true : false}" class="onoffswitch-checkbox" id="element_type_check_in" name="element_type_check_in">
						<label class="onoffswitch-label" for="element_type_check_in">
							<span class="onoffswitch-inner"></span>
							<span class="onoffswitch-switch"></span>
						</label>
					</div>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">是否启用传出校验：</label>
				<div class="col-sm-8">
					<div class="onoffswitch">
						<input type="checkbox" th:checked="*{element_type_check_out == 'yes' ? true : false}" class="onoffswitch-checkbox" id="element_type_check_out" name="element_type_check_out">
						<label class="onoffswitch-label" for="element_type_check_out">
							<span class="onoffswitch-inner"></span>
							<span class="onoffswitch-switch"></span>
						</label>
					</div>
				</div>
			</div>
			-->
<!-- 			<div class="form-group">	 -->
<!-- 				<label class="col-sm-3 control-label">xsd文件路径：</label> -->
<!-- 				<div class="col-sm-8"> -->
<!-- 					<input id="elementTypeXsd" name="elementTypeXsd" class="form-control" type="text"> -->
<!-- 				</div> -->
<!-- 			</div> -->
<!-- 			<div class="form-group">	 -->
<!-- 				<label class="col-sm-3 control-label">服务URL：</label> -->
<!-- 				<div class="col-sm-8"> -->
<!-- 					<input id="path" name="path" class="form-control" type="text"> -->
<!-- 				</div> -->
<!-- 			</div> -->
			<div class="form-group">	
				<label class="col-sm-3 control-label">请求头信息：</label>
				<div class="col-sm-8">
					<input id="reqHeader" name="reqHeader" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">是否有附件：</label>
				<div class="col-sm-8">
					<div class="onoffswitch">
						<input type="checkbox" th:checked="*{attachment == 'yes' ? true : false}" class="onoffswitch-checkbox" id="attachment" name="attachment">
						<label class="onoffswitch-label" for="attachment">
							<span class="onoffswitch-inner"></span>
							<span class="onoffswitch-switch"></span>
						</label>
					</div>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">附件文件名字段：</label>
				<div class="col-sm-8">
					<input id="attachment_fn" name="attachment_fn" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">附件文件内容字段：</label>
				<div class="col-sm-8">
					<input id="attachment_con" name="attachment_con" class="form-control" type="text">
				</div>
			</div>
			
			<div class="form-group">
				<label class="col-sm-3 control-label">URL锁定开关：</label>
				<div class="col-sm-8">
					<div class="onoffswitch">
						<input type="checkbox" th:checked="*{reqUrllock == 'yes' ? true : false}" class="onoffswitch-checkbox" id="reqUrllock" name="reqUrllock">
						<label class="onoffswitch-label" for="reqUrllock">
							<span class="onoffswitch-inner"></span>
							<span class="onoffswitch-switch"></span>
						</label>
					</div>
				</div>
			</div>
<!--			<div class="form-group">	
				<label class="col-sm-3 control-label">URL锁定开关：</label>
				<div class="col-sm-8">
					<input id="reqUrllock" name="reqUrllock" class="form-control" type="text">
				</div>
			</div>
-->
			<div class="form-group">	
				<label class="col-sm-3 control-label">URL锁定地址：</label>
				<div class="col-sm-8">
					<input id="reqPath" name="reqPath" class="form-control" type="text" placeholder="/aaa/bbb/ccc">
				</div>
			</div>
			
			<div class="form-group">
				<div class="form-control-static col-sm-offset-9">
					<button type="submit" class="btn btn-primary">提交</button>
					<button onclick="$.modal.close()" class="btn btn-danger" type="button">关闭</button>
				</div>
			</div>
		</form>
	</div>
    <div th:include="include::footer"></div>
    <script type="text/javascript">
		var prefix = ctx + "module/proxy"
		$("#form-proxy-add").validate({
			// rules:{
			// 	xxxx:{
			// 		required:true,
			// 	},
			// },
            rules:{
                serviceName:{
                    required:true,
                },
				serviceId: {
                    required: true,
                    remote: {
                        url: prefix + "/checkNewServiceID",
                        type:'post',
                        dataType: "json",
                        data: {
                            "serviceId": function() {
                                return $.common.trim($("#serviceId").val());
                            }
                        },
                        dataFilter: function (data, type) {
                            return $.validate.unique(data);
                        }
                    }
				},
                method: {
                    required: true
                },
                protocol: {
                    required: true
                },
                host: {
                    required: true
                },
                allows: {
                    required: true
                },
                port:{
                    required:true,
                    digits:true
                },
                attachment: {
                    required: true
                },
                element_type: {
                    required: true
                }
            },
            messages: {
                "serviceName": {
                    required: "服务名称不能为空"
                },
                "method" : {
                    required: "请求方法必须选择"
                },
                "protocol" : {
                    required: "请求协议必须选择"
                },
                "host" : {
                    required: "服务主机必须填写"
                },
                "allows": {
                    required: "授权主机必须填写"
                },
                "port" : {
                    required: "端口号必须正确填写"
                },
                "element_type" : {
                    required: "访问元素必须填写"
                },
				"serviceId": {
                    required: "serviceId必须填写",
					remote: "serviceId已存在 或 填写不规范"
				}
            },
			submitHandler: function(form) {
				$.operate.save(prefix + "/add", $('#form-proxy-add').serialize());
			}
		});
	</script>
</body>
</html>
